---
layout: post
title: '[JavaScript] ECMAScript 2020'
featured-img: javascript/js.png
category: [tech, javaScript]
summary: ES2020ì— ì¶”ê°€ëœ ê¸°ëŠ¥ì„ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
---
{% include toc.html %}

ES2020(ES11)ì— ì¶”ê°€ëœ ê¸°ëŠ¥ë“¤ì„ ì‚´í‘œë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

# `String.prototype.matchAll`
ë¬¸ìì—´ì—ì„œ ì¼ì¹˜í•˜ëŠ” ì •ê·œì‹ì„ iterator í˜•íƒœë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì‚¬ìš©ë°©ë²•ì€ ê¸°ì¡´ ì •ê·œì‹ `match`ì™€ ë™ì¼í•©ë‹ˆë‹¤.

## `for of` ì‚¬ìš©
iteratorì„ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— `for of` ë¬¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
const str = '11a22ba';
const result = str.matchAll(/a/g);
for (const item of result) {
  console.log(item)
}
/*
['a', index: 2, input: '11a22ba', groups: undefined]
['a', index: 6, input: '11a22ba', groups: undefined]
*/
```

## ë¬¸ìì—´ ì‚¬ìš©
`matchAll` í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë¡œ ë¬¸ìì—´ì„ ì „ë‹¬ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```js
const str = '11a22ba';
const result = str.matchAll('a');
result.next(); // { value: ['a', index: 2, input: '11a22ba', groups: undefinded], done: false }
result.next(); // { value: ['a', index: 6, input: '11a22ba', groups: undefinded], done: false }
result.next(); // { value: undefined, done: true }
```

## ì£¼ì˜ì‚¬í•­
`matchAll` í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë¡œ ì •ê·œì‹ì„ ì „ë‹¬í•  ê²½ìš° ê¸€ë¡œë²Œ ì˜µì…˜(`g`)ì„ ì¤˜ì•¼ í•©ë‹ˆë‹¤. ê¸€ë¡œë²Œ ì˜µì…˜ì´ ì—†ëŠ” ê²½ìš° non-global RegExp ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```js
const str = '11a22ba';
const result = str.matchAll(/a/); // Uncaught TypeError: String.prototype.matchAll called with a non-global RegExp argument
```

# `import()`
ë™ì ìœ¼ë¡œ íŒŒì¼ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê²Œ í•˜ëŠ” `Promise`ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```js
// ğŸ“ say.js
export function hi() {
  alert(`ì•ˆë…•í•˜ì„¸ìš”.`);
}

export function bye() {
  alert(`ì•ˆë…•íˆ ê°€ì„¸ìš”.`);
}
```

```js
let {hi, bye} = await import('./say.js');

hi();
bye();
```

# `BigInt`
ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” 2^53 ë³´ë‹¤ í° ìˆ˜ë¥¼ í‘œí˜„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 2^53 ë³´ë‹¤ í° ìˆ˜ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆë„ë¡ `BigInt`ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

```js
const num = Number.MAX_SAFE_INTEGER;
console.log(num); // 9007199254740991
console.log(num + 1); // 9007199254740992
console.log(num + 2); // 9007199254740992

const bigInt = 9007199254740991n; // ë˜ëŠ” BigInt(9007199254740991)
console.log(bigInt); // 9007199254740991
console.log(bigInt + 1n); // 9007199254740992
console.log(bigInt + 2n); // 9007199254740993
```

`typeof 1n`ì€ `bigint`ì´ê¸° ë•Œë¬¸ì— ë•Œë¬¸ì— ìƒˆë¡œìš´ íƒ€ì…ì´ ìƒê²¼ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íƒ€ì…ì— ì°¨ì´ê°€ ìˆê¸° ë•Œë¬¸ì— `1n`ê³¼ `1`ì€ ì•„ë˜ì™€ ê°™ì´ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.

```js
typeof 1n; // bigint
1n === 1 // false
1n == 1 // true
```

## `Number`ì™€ ìœ ì‚¬ì 
`BigInt` íƒ€ì…ì„ ì‚¬ìš©í•  ë•Œ, `Number` íƒ€ì…ê³¼ ìœ ì‚¬í•œ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì—°ì‚°ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

### í¬ê¸°ë¹„êµ
`1n !== 1`ì´ì§€ë§Œ `Number`ì™€ `BigInt` ì‚¬ì´ì˜ í¬ê¸°ë¹„êµê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```js
1n < 2 // true
2n > 1 // true
2 > 2 // false
2n > 2 // false
2n >= 2 // true
```

### ì •ë ¬
ì •ë ¬ë„ `Number`ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.

```js
const mixed = [4n, 6, -12n, 10, 4, 0, 0n];
mixed.sort(); // [-12n, 0, 0n, 10, 4n, 4, 6]
```

### ì¡°ê±´ íŒë‹¨
ì¡°ê±´ íŒë‹¨ ê¸°ì¤€ ì—­ì‹œ `Number`ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.

```js
if (0n) {
  console.log('Hello from the if!');
} else {
  console.log('Hello from the else!');
} // "Hello from the else!"

0n || 12n // 12n
0n && 12n // 0n
Boolean(0n) // false
Boolean(12n) // true
!12n // false
!0n // true
```

## ì£¼ì˜ì‚¬í•­
`Number` íƒ€ì…ê³¼ ë™ì¼í•˜ê²Œ `BigInt` íƒ€ì…ì„ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í•´ì•¼ í•  ì‚¬í•­ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

### `BigInt`ì™€ `Number` ê°„ì˜ ê³„ì‚°
`BigInt`ì™€ `Number`ê°„ì˜ ê³„ì‚°ì€ `TypeError`ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```js
1n + 2 // TypeError: Cannot mix BigInt and other types, use explicit conversions
1n * 2 // TypeError: Cannot mix BigInt and other types, use explicit conversions
```

### `BigInt`ì—ì„œ `Number`ë¡œ í˜• ë³€í™˜
`+` ì—°ì‚°ì„ ì‚¬ìš©í•´ì„œ `BigInt`ë¥¼ `Number`ë¡œ í˜• ë³€í™˜ë„ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. `BigInt`ë¥¼ `Number`ë¡œ í˜• ë³€í™˜ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” `Number` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```js
+1n // TypeError: Cannot convert a BigInt value to a number
Number(1n) // 1
```

### `Math` í•¨ìˆ˜ì™€ `|` ì—°ì‚°
`Math` í•¨ìˆ˜, `Number`ì™€ `|` ì—°ì‚°ë¥¼ ì‚¬ìš©í•  ë•Œ `TypeError`ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```js
Math.round(1n) // TypeError: Cannot convert a BigInt value to a number
Math.max(1n, 10n) // TypeError: Cannot convert a BigInt value to a number
1n|0 // TypeError: Cannot mix BigInt and other types, use explicit conversions
```

# `Promise.allSettled`
ì•„ë˜ í‘œì™€ ê°™ì´ `Promise.allSettled`ëŠ” Promise ì‘ì—…ì´ ëª¨ë‘ ì¢…ë£Œ ë˜ì—ˆì„ ë•Œì— ë§ˆì¹˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

|name|description|
|:----:|:---:|
|`Promise.allSettled`|ëª¨ë“  ì‘ì—…ì´ `resolve` í˜¹ì€ `reject`ë  ê²½ìš° ì¢…ë£Œë¨|
|`Promise.all`|ëª¨ë“  ì‘ì—…ì´ `resolve`ë˜ê±°ë‚˜, `reject` ëœ ì‘ì—…ì´ ë°œìƒë˜ë©´ ì¢…ë£Œë¨|
|`Promise.race`|`reject` í˜¹ì€ `resolve` ëœ ì‘ì—…ì´ ë°œìƒë˜ë©´ ì¢…ë£Œë¨|
|`Promise.any`|`resolve` ëœ ì‘ì—…ì´ ë°œìƒë˜ë©´ ì¢…ë£Œë¨|

```js
function promise1 () {
  return new Promise((res, rej) => {
    rej('Reject');
  });
}

function promise2 () {
  return new Promise((res, rej) => {
    res('Resolve');
  });
}

async function main () {
  const list = [promise1(), promise2()];
  const result = await Promise.allSettled(list);
  console.log(result);
}

main() // [{status: 'rejected', reason: 'Reject'}, {status: 'fulfilled', value: 'Resolve'}]
```

# `globalThis`
ë¸Œë¼ìš°ì €ì—ì„œ ì „ì—­ ê°ì²´ëŠ” `window`ì´ê³ , Node.jsì˜ ì „ì—­ ê°ì²´ëŠ” `global` ëŸ°íƒ€ì„ ë§ˆë‹¤ ì „ì—­ ê°ì²´ê°€ ë‹¬ë¼ì„œ, ì•„ë˜ì™€ ê°™ì´ ì „ì—­ ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê³µí†µ ì½”ë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

```js
var getGlobal = function () {
	// the only reliable means to get the global object is
	// `Function('return this')()`
	// However, this causes CSP violations in Chrome apps.
	if (typeof self !== 'undefined') { return self; }
	if (typeof window !== 'undefined') { return window; }
	if (typeof global !== 'undefined') { return global; }
	throw new Error('unable to locate global object');
};
```

ES2020ì—ì„œ `globalThis`ê°€ ë“±ì¥í•´ì„œ ì•„ë˜ ì½”ë“œì™€ ê°™ì´ ì–´ë–¤ ëŸ°íƒ€ì„ì´ë“  `globalThis`ë¡œ ì „ì—­ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// browser
globalThis === window; // true
```

```js
// Node.js
globalThis === global; // true
```

# `for-in` ìˆœì„œ
ê¸°ì¡´ì—ëŠ” ë¸Œë¼ìš°ì € ë§ˆë‹¤ `for-in` ë¬¸ì˜ ë°˜ë³µ ìˆœì„œë¥¼ ë³´ì¥í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤(ë¸Œë¼ìš°ì €ë§ˆë‹¤ ë°˜ë³µ ìˆœì„œê°€ ë‹¤ë¥¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤). ES2020ì—ì„œ `for-in` ìˆœì„œë¥¼ ë³´ì¥í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

# Optional Chaining
ê°œì¸ì ìœ¼ë¡œ ES2020ì— ì¶”ê°€ëœ ì‚¬ì–‘ì¤‘ì— ê°€ì¥ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ê°ì²´ì˜ ê°’ì„ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

```js
var street = user.address && user.address.street;
```

# Nullish coalescing Operator

# `import.meta`

#### ì°¸ê³ 
- [https://github.com/tc39/proposals/blob/master/finished-proposals.md](https://github.com/tc39/proposals/blob/master/finished-proposals.md)
- [https://www.zerocho.com/category/ECMAScript/post/5eae7480e70c21001f3e7956](https://www.zerocho.com/category/ECMAScript/post/5eae7480e70c21001f3e7956)
- [https://github.com/tc39/proposal-string-matchall](https://github.com/tc39/proposal-string-matchall)
- [https://www.npmjs.com/package/string.prototype.matchall](https://www.npmjs.com/package/string.prototype.matchall)
- [https://ko.javascript.info/modules-dynamic-imports](https://ko.javascript.info/modules-dynamic-imports)